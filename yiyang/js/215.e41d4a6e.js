"use strict";(self["webpackChunkwannian"]=self["webpackChunkwannian"]||[]).push([[215],{5355:function(e,s,a){a.r(s),a.d(s,{default:function(){return ke}});var t=a(2483),l=a(3396),i=a(4870),o=a(5331),n=(a(9041),a(9357)),d=(a(8185),a(8118)),c=(a(316),a(3649)),r=(a(1958),a(368),a(6742),a(3548)),m=(a(7603),a(3005)),u=(a(5708),a(9545)),g=(a(51),a(8560)),y=a(1719),p=(a(8103),a(7243)),w=(a(7658),a(7139)),k=a(9242),U=a(8349),h=a.p+"img/2.c1005b4a.webp",S=a(868),v=a(9650),x=a(9801);const f=e=>((0,l.dD)("data-v-a5fabc88"),e=e(),(0,l.Cn)(),e),z={class:"wait"},_={class:"header"},b=f((()=>(0,l._)("div",{class:"warn"},"24小时后会话自动关闭",-1))),q={class:"card"},C={key:0,class:"left"},j={key:0,src:U,alt:""},D=["src"],I={key:1,class:"right"},V={class:"name"},W={class:"hui"},F={class:"hui"},$=f((()=>(0,l._)("div",{class:"hui"},"弋阳县人民医院",-1))),O={key:2,class:"right ysr"},N={class:"name"},H=f((()=>(0,l._)("div",{class:"hui mst"},"症状描述：",-1))),T={class:"hui ms"},Y={key:3,class:"btns hui_6"},J=f((()=>(0,l._)("div",{class:"title"},"就诊信息",-1))),K={class:"lt"},P={key:0,class:"xx"},G={class:"date hui"},R={key:0,class:"msg"},Z={key:1,class:"msg"},M=["src","onClick"],B={class:"tx"},L={key:0,src:U,alt:""},E=["src"],Q={key:2,src:h,alt:""},A={key:1,class:"xx"},X={class:"date hui"},ee={key:0,class:"msg"},se={key:1,class:"msg"},ae=["src","onClick"],te={key:0,class:"footer"},le={class:"top"},ie={class:"hidden"},oe={class:"tpsc"},ne=["onClick"],de={class:"icon"},ce={key:1,class:"footer pj"},re=f((()=>(0,l._)("span",null,"星级：",-1))),me={class:"btns"},ue=f((()=>(0,l._)("span",null,"星级：",-1))),ge={class:"btns"};var ye={__name:"LtckView",setup(e){const s=(0,t.yj)(),a=(0,t.tv)(),{proxy:U}=(0,l.FN)(),h=localStorage.getItem("showFlag");console.log(h);const f=s.query.titleId||s.query.titleid,ye=(0,i.iH)(null),pe=(0,i.qj)({data:{}});s.query.data?pe.data=(0,i.qj)(JSON.parse(s.query.data)):U.$axios.post("/chat/getltbt",{openId:localStorage.getItem("token")}).then((e=>{1===e.code&&(pe.data=e.data.find((e=>+e.id===+f)))}));const{data:we}=(0,i.BK)(pe),ke=e=>{a.push(e)},Ue=(0,i.qj)({onOversize(e){(0,S.CF)("文件大小不能超过3MB")},beforeRead(e){const s=e=>{if(!/(.jpg|.jpeg|.png|.JPG|.PNG|.webp|.svg)/g.test(e.type))return(0,S.CF)("请上传正确格式的图片"),!1};return e[0]?e.forEach((e=>{s(e)})):s(e),!0},captrueRead(e){const s=new FormData;s.append("file",e.file),U.$axios.upload("/uploadPic",s).then((e=>{1===e.code&&he.sendxx(e.data[0])}))}}),he=(0,i.qj)({val:"",aname:[],message:"",mymessage:"",star:1,mystar:1,showpj:!1,showmypj:!1,dsqId:"",isys:localStorage.getItem("ysdm"),guishu:(0,l.Fl)((()=>localStorage.getItem("ysdm")||we.value.grxxid)),hidden:!1,fun:[{icon:"icon-charutupian",text:"图片",class:"tp",fn(){ye.value.chooseFile()}},{icon:"icon-caozuo-kaiguan",text:"结束问诊",class:"",fn(){(0,v.WD)({title:"是否却结束本次问诊会话"}).then((()=>{U.$axios.post("/chat/endCaht",{titleId:we.value.id||f,status:3}).then((e=>{he.isys||1!==e.code?he.isys&&1===e.code&&a.replace(`/yslb?ygdm=${we.value?.ygdm}&ysxm=${we.value?.ygxm}`):(we.value.wzzt=3,a.replace({path:"/ltck",query:{data:JSON.stringify(we)}}))}))}))}}],sendxx(e){he.val.trim()||e?U.$axios.post("/chat/sendTexts",{titleId:we.value.id||f,content:he.val,id:he.guishu,tpdz:e}).then((e=>{1===e.code&&(he.updchat(),he.val="")})):(0,S.CF)("发送的消息不能为空")},updchat(){U.$axios.post("/chat/getTheMessageList",{titleId:we.value.id||f}).then((e=>{he.aname=e.data,he.scrollbottom()}))},scrollbottom(){(0,l.Y3)((()=>{setTimeout((()=>{xe.value.scrollTop=xe.value.scrollHeight}),10)}))},yltp(){(0,x.V)({closeable:!0,images:we?.img?.split(",")})},fspj(){he.message.trim()&&U.$axios.post("/chat/insertComment",{titleId:we.value.id||f,ysdm:we.value.ygdm,ysxm:we.value.ygxm,pjnr:he.message,scoreNum:he.star,commentName:we.value.name,openId:localStorage.getItem("token")}).then((e=>{1===e.code&&((0,S.CF)("评论成功，谢谢配合"),he.showpj=!1,U.$axios.post("/chat/endCaht",{titleId:we.value.id||f,status:4}).then((e=>{1===e.code&&a.push("/index")})))}))}});he.updchat(),(0,l.bv)((()=>{he.isys||4!==we.value?.wzzt||U.$axios.post("/chat/getCommentOne",{titleId:we.value.id||f}).then((e=>{he.mymessage=e.data.pjnr,he.mystar=e.data.scoreNum})),he.dsqId=setInterval((()=>{2===we.value?.wzzt?he.updchat():clearInterval(he.dsqId)}),1e3)}));const Se={openId:localStorage.getItem("token"),grxxid:we.value?.grxxid,btid:we.value?.id||f,wzzt:we.value?.wzzt},ve=(0,i.qj)({show:!1,data:[],getxx(){U.$axios.post("/getczxx",Se).then((e=>{ve.data=e.data}))}});he.isys&&ve.getxx(),(0,l.Jd)((()=>{clearInterval(he.dsqId)}));const xe=(0,i.iH)(null);return(0,l.m0)((()=>{he.scrollbottom()})),(0,l.m0)((()=>{he.val&&(he.hidden=!1)})),(e,s)=>{const t=p.Z,U=y.HY,S=g.Z,v=u.zx,f=m.GI,pe=r.gN,fe=c.JO,ze=d.Qm,_e=n.j8,be=o.TS;return(0,l.wg)(),(0,l.iD)("div",z,[(0,l._)("header",_,[b,!(0,i.SU)(he).isys&&[2].includes((0,i.SU)(we)?.wzzt)?((0,l.wg)(),(0,l.j4)(t,{key:0,data:Se})):(0,l.kq)("",!0),(0,l._)("div",q,[(0,i.SU)(he).isys?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",C,[(0,i.SU)(we)?.image?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("img",j)),(0,i.SU)(we)?.image?((0,l.wg)(),(0,l.iD)("img",{key:1,src:(0,i.SU)(we)?.image,alt:""},null,8,D)):(0,l.kq)("",!0)])),(0,i.SU)(he).isys?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",I,[(0,l._)("div",V,(0,w.zw)((0,i.SU)(we)?.ygxm||"医生"),1),(0,l._)("div",W,(0,w.zw)((0,i.SU)(we)?.ygjb||"住院医师"),1),(0,l._)("div",F,(0,w.zw)((0,i.SU)(we)?.ksmc||"科室"),1),$,(0,l.kq)("",!0)])),(0,i.SU)(he).isys?((0,l.wg)(),(0,l.iD)("div",O,[(0,l._)("div",N,(0,w.zw)((0,i.SU)(we)?.name||"患者"),1),H,(0,l._)("div",T,(0,w.zw)((0,i.SU)(we)?.zzms||"症状描述"),1)])):(0,l.kq)("",!0),(0,i.SU)(he).isys?((0,l.wg)(),(0,l.iD)("div",Y,[(0,i.SU)(we)?.img?((0,l.wg)(),(0,l.iD)("div",{key:0,class:"ml",onClick:s[0]||(s[0]=(...e)=>(0,i.SU)(he).yltp&&(0,i.SU)(he).yltp(...e))},"图片信息")):(0,l.kq)("",!0),(0,i.SU)(he).isys&&(0,i.SU)(ve).data&&(0,i.SU)(ve).data.length?((0,l.wg)(),(0,l.iD)("div",{key:1,class:"ml cz",onClick:s[1]||(s[1]=e=>(0,i.SU)(ve).show=!0)},"就诊信息")):(0,l.kq)("",!0),(0,l.kq)("",!0),(0,i.SU)(he).isys?((0,l.wg)(),(0,l.j4)(f,{key:3,show:(0,i.SU)(ve).show,"onUpdate:show":s[3]||(s[3]=e=>(0,i.SU)(ve).show=e),closeable:"",position:"bottom",style:(0,w.j5)({height:"100%",padding:"1rem 0.2rem 0"})},{default:(0,l.w5)((()=>[J,(0,i.SU)(ve).data.length?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(U,{key:0,"image-size":"2rem",description:"没有就诊信息"})),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,i.SU)(ve).data,(e=>((0,l.wg)(),(0,l.j4)(S,{key:e,data:e},null,8,["data"])))),128)),(0,l.wy)((0,l.Wm)(v,{round:"",size:"large",type:"primary",onClick:s[2]||(s[2]=e=>{(0,i.SU)(ve).data.push({xz:!0}),(0,i.SU)(ve).cstate=!0})},{default:(0,l.w5)((()=>[(0,l.Uk)("新建就诊信息")])),_:1},512),[[k.F8,(0,i.SU)(ve).upd&&!(0,i.SU)(ve).data.length]])])),_:1},8,["show","style"])):(0,l.kq)("",!0)])):(0,l.kq)("",!0),(0,i.SU)(he).isys||0!==+(0,i.SU)(h)?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",{key:4,class:"backhome",onClick:s[4]||(s[4]=e=>ke("/index"))}," 回到首页 ")),(0,i.SU)(he).isys||1!==+(0,i.SU)(h)?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("div",{key:5,class:"backhome",onClick:s[5]||(s[5]=e=>ke("/home"))}," 回到首页 ")),(0,i.SU)(he).isys?((0,l.wg)(),(0,l.iD)("div",{key:6,class:"backhome",onClick:s[6]||(s[6]=e=>ke(`/yslb?ygdm=${(0,i.SU)(we)?.ygdm}&ysxm=${(0,i.SU)(we)?.ygxm}`))}," 返回列表 ")):(0,l.kq)("",!0)])]),(0,l._)("div",{ref_key:"view",ref:xe,class:"view",onClick:s[7]||(s[7]=e=>(0,i.SU)(he).hidden=!1)},[(0,l._)("div",K,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,i.SU)(he).aname,(e=>((0,l.wg)(),(0,l.iD)("div",{class:(0,w.C_)(+(0,i.SU)(he).guishu===+e.fsz?"mine ltxx":"other ltxx"),key:e.id},[+(0,i.SU)(he).guishu===+e.fsz?((0,l.wg)(),(0,l.iD)("div",P,[(0,l._)("div",G,(0,w.zw)(e.startime?.slice(0,-3)),1),e.xxnr.trim()?((0,l.wg)(),(0,l.iD)("div",R,(0,w.zw)(e.xxnr.trim()),1)):(0,l.kq)("",!0),e.tpxx?((0,l.wg)(),(0,l.iD)("div",Z,[(0,l._)("img",{src:e.tpxx,onClick:s=>(0,i.SU)(x.V)({closeable:!0,images:[e.tpxx]}),alt:""},null,8,M)])):(0,l.kq)("",!0)])):(0,l.kq)("",!0),(0,l._)("div",B,[(0,i.SU)(we).image||+(0,i.SU)(we).ygdm!==+e.fsz?(0,l.kq)("",!0):((0,l.wg)(),(0,l.iD)("img",L)),(0,i.SU)(we).image&&+(0,i.SU)(we).ygdm===+e.fsz?((0,l.wg)(),(0,l.iD)("img",{key:1,src:(0,i.SU)(we).image,alt:""},null,8,E)):(0,l.kq)("",!0),+(0,i.SU)(we).ygdm!==+e.fsz?((0,l.wg)(),(0,l.iD)("img",Q)):(0,l.kq)("",!0)]),+(0,i.SU)(he).guishu!==+e.fsz?((0,l.wg)(),(0,l.iD)("div",A,[(0,l._)("div",X,(0,w.zw)(e.startime?.slice(0,-3)),1),e.xxnr.trim()?((0,l.wg)(),(0,l.iD)("div",ee,(0,w.zw)(e.xxnr.trim()),1)):(0,l.kq)("",!0),e.tpxx?((0,l.wg)(),(0,l.iD)("div",se,[(0,l._)("img",{src:e.tpxx,onClick:s=>(0,i.SU)(x.V)({closeable:!0,images:[e.tpxx]}),alt:""},null,8,ae)])):(0,l.kq)("",!0)])):(0,l.kq)("",!0)],2)))),128))])],512),(0,i.SU)(he).isys||2===(0,i.SU)(we)?.wzzt?((0,l.wg)(),(0,l.iD)("footer",te,[(0,l._)("div",le,[(0,l.Wm)(pe,{class:"ipt",autosize:"",rows:"1","max-rows":"4",type:"textarea",modelValue:(0,i.SU)(he).val,"onUpdate:modelValue":s[8]||(s[8]=e=>(0,i.SU)(he).val=e),placeholder:"请输入文字"},null,8,["modelValue"]),(0,l.wy)((0,l.Wm)(v,{class:"btn",type:"success",onClick:s[9]||(s[9]=e=>(0,i.SU)(he).sendxx(""))},{default:(0,l.w5)((()=>[(0,l.Uk)("发送")])),_:1},512),[[k.F8,(0,i.SU)(he).val]]),(0,l.wy)((0,l.Wm)(fe,{class:"more",name:"add-o",onClick:s[10]||(s[10]=e=>(0,i.SU)(he).hidden=!(0,i.SU)(he).hidden)},null,512),[[k.F8,!(0,i.SU)(he).val]])]),(0,l.wy)((0,l._)("div",ie,[(0,l._)("div",oe,[(0,l.Wm)(ze,{ref_key:"tpsc",ref:ye,"show-upload":!1,"preview-image":!1,class:"ipt",onOversize:(0,i.SU)(Ue).onOversize,"before-read":(0,i.SU)(Ue).beforeRead,"after-read":(0,i.SU)(Ue).captrueRead,"max-size":3145728,"max-count":1},null,8,["onOversize","before-read","after-read"])]),((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)((0,i.SU)(he).fun,(e=>((0,l.wg)(),(0,l.iD)("div",{class:(0,w.C_)("fun "+e.class),key:e.text,onClick:e.fn},[(0,l._)("div",de,[(0,l._)("i",{class:(0,w.C_)("iconfont "+e.icon)},null,2)]),(0,l._)("div",null,(0,w.zw)(e.text),1)],10,ne)))),128))],512),[[k.F8,(0,i.SU)(he).hidden]])])):(0,l.kq)("",!0),!(0,i.SU)(he).isys&&3===(0,i.SU)(we)?.wzzt||4===(0,i.SU)(we)?.wzzt?((0,l.wg)(),(0,l.iD)("footer",ce,[(0,i.SU)(he).isys||3!==(0,i.SU)(we)?.wzzt?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(v,{key:0,class:"btn",plain:"",onClick:s[11]||(s[11]=e=>(0,i.SU)(he).showpj=!0),type:"primary"},{default:(0,l.w5)((()=>[(0,l.Uk)("点击评价")])),_:1})),(0,i.SU)(he).isys||4!==(0,i.SU)(we)?.wzzt?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(v,{key:1,class:"btn two",plain:"",onClick:s[12]||(s[12]=e=>(0,i.SU)(he).showmypj=!0),type:"primary"},{default:(0,l.w5)((()=>[(0,l.Uk)("我的评价")])),_:1})),(0,i.SU)(he).isys||4!==(0,i.SU)(we)?.wzzt?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(v,{key:2,class:"btn two",onClick:s[13]||(s[13]=e=>(0,i.SU)(a).push("/index")),type:"success"},{default:(0,l.w5)((()=>[(0,l.Uk)("再次问诊")])),_:1}))])):(0,l.kq)("",!0),(0,i.SU)(he).isys||3!==(0,i.SU)(we)?.wzzt?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(f,{key:2,class:"tc",show:(0,i.SU)(he).showpj,"onUpdate:show":s[17]||(s[17]=e=>(0,i.SU)(he).showpj=e),position:"bottom",style:{height:"35%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(be,{inset:"",class:"group"},{default:(0,l.w5)((()=>[re,(0,l.Wm)(_e,{color:"#fd7916",size:"0.3rem",modelValue:(0,i.SU)(he).star,"onUpdate:modelValue":s[14]||(s[14]=e=>(0,i.SU)(he).star=e)},null,8,["modelValue"]),(0,l.Wm)(pe,{modelValue:(0,i.SU)(he).message,"onUpdate:modelValue":s[15]||(s[15]=e=>(0,i.SU)(he).message=e),rows:"3",autosize:"",label:"评价:","label-class":"lab",type:"textarea",maxlength:"100",placeholder:"请根据真实情况对本次问诊填写客官评价","show-word-limit":"","label-align":"top"},null,8,["modelValue"])])),_:1}),(0,l._)("div",me,[(0,l.Wm)(v,{class:"btn qx",square:"",type:"primary",onClick:s[16]||(s[16]=e=>(0,i.SU)(he).showpj=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("暂不评价")])),_:1}),(0,l.Wm)(v,{class:"btn pj",square:"",type:"success",onClick:(0,i.SU)(he).fspj},{default:(0,l.w5)((()=>[(0,l.Uk)("评价")])),_:1},8,["onClick"])])])),_:1},8,["show"])),(0,i.SU)(he).isys||4!==(0,i.SU)(we)?.wzzt?(0,l.kq)("",!0):((0,l.wg)(),(0,l.j4)(f,{key:3,class:"tc",show:(0,i.SU)(he).showmypj,"onUpdate:show":s[21]||(s[21]=e=>(0,i.SU)(he).showmypj=e),position:"bottom",style:{height:"32%"}},{default:(0,l.w5)((()=>[(0,l.Wm)(be,{inset:"",class:"group"},{default:(0,l.w5)((()=>[ue,(0,l.Wm)(_e,{readonly:"",color:"#fd7916",size:"0.3rem",modelValue:(0,i.SU)(he).mystar,"onUpdate:modelValue":s[18]||(s[18]=e=>(0,i.SU)(he).mystar=e)},null,8,["modelValue"]),(0,l.Wm)(pe,{modelValue:(0,i.SU)(he).mymessage,"onUpdate:modelValue":s[19]||(s[19]=e=>(0,i.SU)(he).mymessage=e),rows:"3",autosize:"",readonly:"",label:"评价:","label-class":"lab",type:"textarea","label-align":"top"},null,8,["modelValue"])])),_:1}),(0,l._)("div",ge,[(0,l.Wm)(v,{class:"btn pj",square:"",type:"success",onClick:s[20]||(s[20]=e=>(0,i.SU)(he).showmypj=!1)},{default:(0,l.w5)((()=>[(0,l.Uk)("关闭")])),_:1})])])),_:1},8,["show"]))])}}},pe=a(89);const we=(0,pe.Z)(ye,[["__scopeId","data-v-a5fabc88"]]);var ke=we},8185:function(e,s,a){a(1958),a(368),a(6742)},868:function(e,s,a){a.d(s,{CF:function(){return k}});a(7658);var t=a(3396),l=a(4870),i=a(2220),o=a(6491),n=a(7548),d=a(2727);const c={icon:"",type:"text",message:"",className:"",overlay:!1,onClose:void 0,onOpened:void 0,duration:2e3,teleport:"body",iconSize:void 0,iconPrefix:void 0,position:"middle",transition:"van-fade",forbidClick:!1,loadingType:void 0,overlayClass:"",overlayStyle:void 0,closeOnClick:!1,closeOnClickOverlay:!1};let r=[],m=!1,u=(0,i.l7)({},c);const g=new Map;function y(e){return(0,o.Kn)(e)?e:{message:e}}function p(){const{instance:e,unmount:s}=(0,n.H)({setup(){const a=(0,l.iH)(""),{open:i,state:o,close:c,toggle:u}=(0,n.o)(),g=()=>{m&&(r=r.filter((s=>s!==e)),s())},y=()=>{const e={onClosed:g,"onUpdate:show":u};return(0,t.Wm)(d.Z,(0,t.dG)(o,e),null)};return(0,t.YP)(a,(e=>{o.message=e})),(0,t.FN)().render=y,{open:i,close:c,message:a}}});return e}function w(){if(!r.length||m){const e=p();r.push(e)}return r[r.length-1]}function k(e={}){if(!i._f)return{};const s=w(),a=y(e);return s.open((0,i.l7)({},u,g.get(a.type||u.type),a)),s}const U=e=>s=>k((0,i.l7)({type:e},y(s)));U("loading"),U("success"),U("fail")},316:function(e,s,a){a(1958),a(368),a(6742),a(7179),a(2939),a(6196),a(2666),a(9137),a(1088),a(6300)}}]);
//# sourceMappingURL=215.e41d4a6e.js.map