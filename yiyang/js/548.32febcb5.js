"use strict";(self["webpackChunkwannian"]=self["webpackChunkwannian"]||[]).push([[548],{2298:function(e,l,o){o.r(l),o.d(l,{default:function(){return C}});var n=o(3396),a=o(4870),t=o(2483),s=o(6944),u=(o(3277),o(9545)),m=(o(51),o(5331)),d=(o(9041),o(2715)),r=(o(3156),o(3005)),i=(o(5708),o(9264)),c=(o(2196),o(3548)),h=(o(7603),o(7658),o(6811)),p=o(776),f=o(868),w=o(9650);const g={class:"jk"},U={style:{margin:"16px"}};var x={__name:"JkView",setup(e){(0,p.di)({duration:1e3});const{proxy:l}=(0,n.FN)(),o=(0,t.tv)(),x=(0,a.qj)({name:"",sfz:"",sex:"",szd:"",xxdz:"",lxdh:"",mz:"",gx:"",jzk:"",openId:localStorage.getItem("token")}),{name:z,sfz:S,sex:C,szd:v,xxdz:k,lxdh:V,mz:b,gx:W}=(0,a.BK)(x),y=(0,a.qj)({sfz:/(^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$)|(^[1-9]\d{5}\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{2}$)/,phone:/^1((34[0-8])|(8\d{2})|(([35][0-35-9]|4[579]|66|7[35678]|9[1389])\d{1}))\d{7}$/}),q=(0,a.qj)({sex:"",showsex:!1,columns:[{text:"女",value:"0"},{text:"男",value:"1"}],onConfirm({selectedOptions:e}){q.sex=e[0]?.text,C.value=e[0]?.value,q.showsex=!1}}),j=(0,a.qj)({showArea:!1,val:"361126",onConfirm({selectedOptions:e}){j.showArea=!1,v.value=e.map((e=>e.text)).join("/")}}),_=(0,a.qj)({showmz:!1,mzlist:["汉族","蒙古族","回族","藏族","维吾尔族","苗族","彝族","壮族","布依族","朝鲜族","满族","侗族","瑶族","白族","土家族","哈尼族","哈萨克族","傣族","黎族","僳僳族","佤族","畲族","高山族","拉祜族","水族","东乡族","纳西族","景颇族","柯尔克孜族","土族","达斡尔族","仫佬族","羌族","布朗族","撒拉族","毛南族","仡佬族","锡伯族","阿昌族","普米族","塔吉克族","怒族","乌孜别克族","俄罗斯族","鄂温克族","德昂族","保安族","裕固族","京族","塔塔尔族","独龙族","鄂伦春族","赫哲族","门巴族","珞巴族","基诺族"],columns:(0,n.Fl)((()=>{const e=(0,a.qj)([]);return _.mzlist.forEach((l=>{e.push({text:l,value:l})})),e})),onConfirm({selectedOptions:e}){b.value=e[0]?.text,_.showmz=!1}}),B=(0,a.qj)({showgx:!1,columns:[{text:"本人",value:"本人"},{text:"家人",value:"家人"},{text:"朋友",value:"朋友"}],onConfirm({selectedOptions:e}){W.value=e[0]?.text,B.showgx=!1}}),D=e=>{for(const l in e)if("jzk"!==l&&"brid"!==l&&(!e[l]||0===e[l]))return!1;return!0},$=e=>{l.$axios.post("/findRegist",x).then((l=>{1===l.code&&(e&&(0,f.CF)({type:"primary",message:e}),o.go(-1))}))},A={getDate(e){return`${e?.slice(6,10)}-${e?.slice(10,12)}-${e?.slice(12,14)}`},getAge(e){const l=new Date,o=new Date(e);let n=l.getFullYear()-o.getFullYear();return(l.getMonth()<o.getMonth()||l.getMonth()===o.getMonth()&&l.getDate()<o.getDate())&&n--,n}},I=(0,a.qj)({zt:0,map:{0:()=>{(0,p.NU)({type:"primary",message:"请完善信息"})},1:()=>{l.$axios.post("/showPatientId",{sfzh:x.sfz}).then((e=>{1===e.code?(0,w.WD)({message:`检测到您已经创建过就诊卡${e.data.mzkh}，是否直接绑定`}).then((()=>{x.id=I?.id,x.jzk=e.data.mzkh,x.brid=e.data.brid,$("就诊卡绑定成功")})).catch((()=>"")):(x.appBirth=A.getDate(x?.sfz),x.appAge=A.getAge(x?.appBirth),l.$axios.post("/createCard",x).then((e=>{1===e.code&&((0,f.CF)("就诊卡创建绑定成功"),o.go(-1))})))}))}},fn(){I.map[I.zt]&&I.map[I.zt]()}});return(0,n.YP)((()=>x.sfz),(()=>{y.sfz.test(x.sfz)&&18===x.sfz.length&&l.$axios.post("/showPatientInfo",{openId:localStorage.getItem("token"),sfzh:x.sfz}).then((e=>{if(1===e.code){for(const l in x)"sex"===l?(q.sex=0===+e.data?.sex?"女":"男",C.value=e.data?.sex):e.data[l]&&(x[l]=e.data[l]);I.id=e.data.id}else{for(const e in x)"sfz"!==e&&(x[e]="");q.sex="",I.zt=0}}))})),(0,n.m0)((()=>{D(x)?I.zt=1:I.zt=0})),(e,l)=>{const o=c.gN,t=i.cW,p=r.GI,f=d.uN,w=m.TS,x=u.zx,C=s.l0;return(0,n.wg)(),(0,n.iD)("div",g,[(0,n.Wm)(C,null,{default:(0,n.w5)((()=>[(0,n.Wm)(w,{inset:"",class:"bd"},{default:(0,n.w5)((()=>[(0,n.Wm)(o,{modelValue:(0,a.SU)(S),"onUpdate:modelValue":l[0]||(l[0]=e=>(0,a.dq)(S)?S.value=e:null),name:"身份证",label:"身份证",size:"large",placeholder:"请输入身份证号",rules:[{pattern:(0,a.SU)(y).sfz,message:"请输入合法的身份证"}]},null,8,["modelValue","rules"]),(0,n.Wm)(o,{modelValue:(0,a.SU)(z),"onUpdate:modelValue":l[1]||(l[1]=e=>(0,a.dq)(z)?z.value=e:null),name:"姓名",label:"姓名",size:"large",placeholder:"请输入姓名",rules:[{required:!0,message:"请输入姓名"}]},null,8,["modelValue"]),(0,n.Wm)(o,{modelValue:(0,a.SU)(q).sex,"onUpdate:modelValue":l[2]||(l[2]=e=>(0,a.SU)(q).sex=e),"is-link":"",readonly:"",name:"性别",label:"性别",size:"large",placeholder:"请选择性别",onClick:l[3]||(l[3]=e=>(0,a.SU)(q).showsex=!0)},null,8,["modelValue"]),(0,n.Wm)(p,{show:(0,a.SU)(q).showsex,"onUpdate:show":l[5]||(l[5]=e=>(0,a.SU)(q).showsex=e),position:"bottom"},{default:(0,n.w5)((()=>[(0,n.Wm)(t,{columns:(0,a.SU)(q).columns,onConfirm:(0,a.SU)(q).onConfirm,onCancel:l[4]||(l[4]=e=>(0,a.SU)(q).showsex=!1)},null,8,["columns","onConfirm"])])),_:1},8,["show"]),(0,n.Wm)(o,{modelValue:(0,a.SU)(v),"onUpdate:modelValue":l[6]||(l[6]=e=>(0,a.dq)(v)?v.value=e:null),"is-link":"",readonly:"",size:"large",name:"所在地",label:"所在地",placeholder:"请选择选择所在地区",onClick:l[7]||(l[7]=e=>(0,a.SU)(j).showArea=!0)},null,8,["modelValue"]),(0,n.Wm)(p,{show:(0,a.SU)(j).showArea,"onUpdate:show":l[10]||(l[10]=e=>(0,a.SU)(j).showArea=e),position:"bottom"},{default:(0,n.w5)((()=>[(0,n.Wm)(f,{modelValue:(0,a.SU)(j).val,"onUpdate:modelValue":l[8]||(l[8]=e=>(0,a.SU)(j).val=e),"area-list":(0,a.SU)(h.H),onConfirm:(0,a.SU)(j).onConfirm,onCancel:l[9]||(l[9]=e=>(0,a.SU)(j).showArea=!1)},null,8,["modelValue","area-list","onConfirm"])])),_:1},8,["show"]),(0,n.Wm)(o,{modelValue:(0,a.SU)(k),"onUpdate:modelValue":l[11]||(l[11]=e=>(0,a.dq)(k)?k.value=e:null),name:"详细地址",label:"详细地址",size:"large",placeholder:"请输入详细地址",rules:[{required:!0,message:"请填写详细地址"}]},null,8,["modelValue"]),(0,n.Wm)(o,{modelValue:(0,a.SU)(V),"onUpdate:modelValue":l[12]||(l[12]=e=>(0,a.dq)(V)?V.value=e:null),name:"联系电话",label:"联系电话",size:"large",placeholder:"请输入联系电话",rules:[{pattern:(0,a.SU)(y).phone,message:"请输入正确的手机号"}]},null,8,["modelValue","rules"]),(0,n.Wm)(o,{modelValue:(0,a.SU)(b),"onUpdate:modelValue":l[13]||(l[13]=e=>(0,a.dq)(b)?b.value=e:null),"is-link":"",readonly:"",name:"民族",label:"民族",size:"large",placeholder:"请选择民族",onClick:l[14]||(l[14]=e=>(0,a.SU)(_).showmz=!0)},null,8,["modelValue"]),(0,n.Wm)(p,{show:(0,a.SU)(_).showmz,"onUpdate:show":l[16]||(l[16]=e=>(0,a.SU)(_).showmz=e),position:"bottom"},{default:(0,n.w5)((()=>[(0,n.Wm)(t,{columns:(0,a.SU)(_).columns,onConfirm:(0,a.SU)(_).onConfirm,onCancel:l[15]||(l[15]=e=>(0,a.SU)(_).showmz=!1)},null,8,["columns","onConfirm"])])),_:1},8,["show"]),(0,n.Wm)(o,{modelValue:(0,a.SU)(W),"onUpdate:modelValue":l[17]||(l[17]=e=>(0,a.dq)(W)?W.value=e:null),"is-link":"",readonly:"",name:"关系",label:"和本人关系",size:"large",placeholder:"请选择关系",onClick:l[18]||(l[18]=e=>(0,a.SU)(B).showgx=!0)},null,8,["modelValue"]),(0,n.Wm)(p,{show:(0,a.SU)(B).showgx,"onUpdate:show":l[20]||(l[20]=e=>(0,a.SU)(B).showgx=e),position:"bottom"},{default:(0,n.w5)((()=>[(0,n.Wm)(t,{columns:(0,a.SU)(B).columns,onConfirm:(0,a.SU)(B).onConfirm,onCancel:l[19]||(l[19]=e=>(0,a.SU)(B).showgx=!1)},null,8,["columns","onConfirm"])])),_:1},8,["show"])])),_:1}),(0,n._)("div",U,[(0,n.Wm)(x,{round:"",block:"",type:"primary",onClick:(0,a.SU)(I).fn},{default:(0,n.w5)((()=>[(0,n.Uk)(" 创建就诊卡 ")])),_:1},8,["onClick"])])])),_:1})])}}},z=o(89);const S=(0,z.Z)(x,[["__scopeId","data-v-314f84b4"]]);var C=S},9650:function(e,l,o){o.d(l,{WD:function(){return c},gk:function(){return h}});var n=o(3396),a=o(2220),t=o(7548),s=o(8647);let u;const m={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let d=(0,a.l7)({},m);function r(){const e={setup(){const{state:e,toggle:l}=(0,t.o)();return()=>(0,n.Wm)(s.Z,(0,n.dG)(e,{"onUpdate:show":l}),null)}};({instance:u}=(0,t.H)(e))}function i(e){return a._f?new Promise(((l,o)=>{u||r(),u.open((0,a.l7)({},d,e,{callback:e=>{("confirm"===e?l:o)(e)}}))})):Promise.resolve()}const c=e=>i((0,a.l7)({showCancelButton:!0},e)),h=()=>{u&&u.toggle(!1)}}}]);
//# sourceMappingURL=548.32febcb5.js.map